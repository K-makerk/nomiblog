<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>おすすめリンク集 | makeappkblog</title>
  <meta name="description" content="SNSプロフィールからのリンク集ページです。本ページにはPR／アフィリエイトリンクを含みます。">
  <meta name="robots" content="noindex,nofollow"><!-- 検索インデックスは不要 -->
  <link rel="preconnect" href="https://www.googletagmanager.com">

  <style>
    :root { --bg:#fafafa; --ink:#111; --ink-2:#444; --muted:#666; }
    * { box-sizing: border-box; }
    body {
      font-family: system-ui, -apple-system, "Noto Sans JP", sans-serif;
      margin: 0; padding: 24px; background: var(--bg); color: var(--ink);
    }
    .wrap { max-width: 520px; margin: 0 auto; }
    h1 { font-size: 22px; margin: 12px 0; text-align: center; }
    .note { font-size: 12px; color: var(--muted); margin: 8px 0 20px; text-align: center; }
    a.btn {
      display: block; text-align: center; margin: 12px 0; padding: 14px 16px;
      border-radius: 10px; background: var(--ink); color: #fff; text-decoration: none;
      font-weight: 600; transition: background .2s ease;
    }
    a.btn:hover { background: #333; }
    a.btn.secondary { background: var(--ink-2); }
    footer { margin-top: 20px; font-size: 12px; color: #777; text-align: center; }
  </style>

  <!-- Google tag (GA4) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DNJVM8DWV6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-DNJVM8DWV6', { 'anonymize_ip': true });
  </script>
</head>
<body>
  <div class="wrap">
    <h1>おすすめリンク集</h1>
    <div class="note">※本ページにはPR／アフィリエイトリンクを含みます</div>

    <!-- ▼▼ ここを実案件URLに置き換えてください（UTMは自動付与されます） ▼▼ -->
    <a class="btn" href="#" target="_blank" rel="nofollow sponsored noopener"
       data-utm="1" data-label="案件A：無料体験">案件A（例：無料体験はこちら）</a>

    <a class="btn" href="#" target="_blank" rel="nofollow sponsored noopener"
       data-utm="1" data-label="案件B：資料請求">案件B（例：資料請求はこちら）</a>
    <!-- ▲▲ ここまで ▲▲ -->

    <!-- ブログTOP（アフィリではないので sponsored は付けていません） -->
    <a class="btn secondary" href="https://www.makeappkblog.com/" rel="nofollow" data-label="ブログTOPへ">
      ブログTOPへ戻る
    </a>

    <footer>© 2025 makeappkblog</footer>
  </div>

  <!-- クリック計測 & UTM自動付与（外部リンクのみ） -->
  <script>
    (function () {
      // 参照元から utm_source を推定（Instagram/TikTok/その他）
      function detectSource(ref) {
        if (!ref) return 'direct';
        ref = ref.toLowerCase();
        if (ref.includes('instagram.com') || ref.includes('l.instagram.com')) return 'instagram';
        if (ref.includes('tiktok.com') || ref.includes('t.co')) return 'tiktok';
        return 'site';
      }
      const utmSource = detectSource(document.referrer);

      // YYYY-MM を自動生成（例: 2025-08）
      const ym = new Date();
      const utmCampaign = ym.getFullYear() + '-' + String(ym.getMonth() + 1).padStart(2, '0');

      // UTMが未設定なら付与し、クリックイベントをGA4送信
      function addOrKeepUTM(url) {
        try {
          const u = new URL(url, location.href);
          if (!u.searchParams.has('utm_source'))  u.searchParams.set('utm_source', utmSource);
          if (!u.searchParams.has('utm_medium'))  u.searchParams.set('utm_medium', 'bio');
          if (!u.searchParams.has('utm_campaign'))u.searchParams.set('utm_campaign', utmCampaign);
          return u.toString();
        } catch (e) { return url; }
      }

      document.querySelectorAll('a.btn').forEach(function (link) {
        link.addEventListener('click', function (e) {
          const label = link.getAttribute('data-label') || link.textContent.trim();
          let href = link.getAttribute('href') || '#';

          // 外部リンクかつ data-utm=1 のときだけUTMを付与
          const isExternal = /^https?:\/\//i.test(href) && (new URL(href, location.href)).host !== location.host;
          if (isExternal && link.dataset.utm === '1') {
            href = addOrKeepUTM(href);
            link.setAttribute('href', href);
          }

          // GA4 カスタムイベント（リンククリック）
          if (typeof gtag === 'function') {
            gtag('event', 'link_click', {
              link_text: label,
              link_url: href,
              page_location: location.href
            });
          }
        }, { passive: true });
      });
    })();
  </script>

  <noscript>このページはJavaScriptを使用しています。リンク計測は無効になります。</noscript>
</body>
</html>
